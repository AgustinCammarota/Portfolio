---
import { getCollection } from 'astro:content';
import { getLangFromUrl } from "@i18n/utils";
import Section from '@components/Section.astro';
import ProjectCard from '@components/ProjectCard.astro';

const lang = getLangFromUrl(Astro.url);

const projectsCollection = await getCollection('projects', ({ id }) => {
    return id.startsWith(`${lang}/`);
});
---

<Section name="projects">
    {projectsCollection.map((project) => (
        <ProjectCard
            image={project.data.image.src}
            alt={project.data.image.alt}
            title={project.data.title}
            video={project.data.video}
            technologies={project.data.technologies}
            hasLink={project.data.hasLink}
            github={project.data.github}
            hasWebsite={project.data.hasWebsite}
            website={project.data.website}>
            <Fragment slot="description">
              {project.render().then(({ Content }) => <Content/>)}
            </Fragment>
        </ProjectCard>
    ))}
</Section>
